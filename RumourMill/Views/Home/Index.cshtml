
@using WebMatrix.Data;

@{


    ViewBag.Title = "The Rumour Mill";

    var text = "";

    if (IsPost)
    {
        text = Request.Form["text"];
        var db = Database.Open("RumourMillMain");
        var insertCommand = "INSERT INTO Questions (QuestionText) VALUES(@0)";
        db.Execute(insertCommand, text);
        Response.Redirect("~/Home");
    }

}

<div class="jumbotron">
    <h1>The Rumour Mill</h1>
    <p class="lead">Have a question you've heard that you think needs answered? Submit it here</p>
</div>
<h2>Add your question</h2>
<form method="post">
    <fieldset>
        <p>
            <input type="text" name="text" placeholder="Enter your question" value="@Request.Form["title"]" />
        </p>

        <p><input type="submit" name="buttonSubmit" value="Submit" /></p>
    </fieldset>
</form>
<h2>Questions</h2>
<div class="container">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Question ID</th>
                <th>Question Text</th>
                <th>Has Been Approved</th>
                <th>Has Been Answered</th>
                <th>Answered By</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var q in Model)
            {
                <tr>
                    <td>@q.QuestionId</td>
                    <td>@q.QuestionText</td>
                    <td>@q.IsApproved</td>
                    <td>@q.IsAnswered</td>
                    <td>@q.AnsweredBy</td>
                </tr>
            }
        </tbody>
    </table>
</div>

